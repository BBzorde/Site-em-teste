<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promoções - F5 Games</title>
    <!-- Incluindo Tailwind CSS via CDN para estilo rápido e responsivo -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Inter para uma tipografia moderna e limpa -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* Fundo escuro para tema gamer */
            color: #e2e8f0; /* Cor do texto clara */
        }
        .container {
            max-width: 1200px;
        }
        /* Estilo para preço original riscado */
        .original-price {
            text-decoration: line-through;
            color: #9ca3af; /* text-gray-400 */
            font-size: 0.9em;
            margin-right: 0.5rem;
        }
        /* Estilo para preço final */
        .final-price {
            color: #34d399; /* text-green-400 */
            font-weight: bold;
            font-size: 1.1em;
        }
        /* Estilo para a porcentagem de desconto */
        .discount-percent {
            background-color: #ef4444; /* bg-red-500 */
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-weight: bold;
            font-size: 0.85em;
            margin-right: 0.5rem;
        }
    </style>
</head>
<body class="antialiased">
    <!-- Cabeçalho do Site -->
    <header class="bg-gray-900 py-4 shadow-lg">
        <div class="container mx-auto flex flex-col md:flex-row items-center justify-between px-4">
            <!-- Logo/Nome do Site -->
            <a href="index.html" class="mb-4 md:mb-0">
                <img src="https://i.ibb.co/Q7QTMNrt/key-f5-symbol-black-computer-260nw-1968799435.webp" alt="Logotipo F5 Games" class="h-12 w-auto rounded-md">
            </a>
            <!-- Menu de Navegação -->
            <nav>
                <ul class="flex flex-wrap justify-center space-x-6">
                    <li><a href="index.html" class="text-gray-300 hover:text-blue-400 text-lg font-semibold transition duration-300">Início</a></li>
                    <li><a href="noticias.html" class="text-gray-300 hover:text-blue-400 text-lg font-semibold transition duration-300">Notícias</a></li>
                    <li><a href="analises.html" class="text-gray-300 hover:text-blue-400 text-lg font-semibold transition duration-300">Análises</a></li>
                    <!-- Link "Promoções" agora ativo -->
                    <li><a href="promocoes.html" class="text-blue-400 text-lg font-semibold transition duration-300">Promoções</a></li>
                    <li><a href="contato.html" class="text-gray-300 hover:text-blue-400 text-lg font-semibold transition duration-300">Contato</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Conteúdo da Página de Promoções -->
    <main class="container mx-auto px-4 py-12 min-h-screen">
        <section>
            <h1 class="text-4xl font-bold text-white mb-8 text-center">Promoções Imperdíveis!</h1>
            <p class="text-gray-300 text-lg mb-10 text-center">
                Fique por dentro das melhores ofertas e descontos do mundo dos games! Atualizamos esta página regularmente com as promoções mais quentes diretamente da Steam.
            </p>

            <div id="promotions-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                <!-- As promoções serão carregadas aqui pelo JavaScript -->
                <p id="loading-message" class="col-span-full text-center text-gray-400">Carregando promoções...</p>
                <p id="error-message" class="col-span-full text-center text-red-500 hidden">Erro ao carregar promoções. Por favor, verifique a URL da função Cloud Functions e sua configuração (CORS).</p>
            </div>
        </section>
    </main>

    <!-- Rodapé do Site -->
    <footer class="bg-gray-900 py-8 mt-12">
        <div class="container mx-auto px-4 text-center text-gray-400">
            <p>&copy; 2025 F5 Games. Todos os direitos reservados.</p>
            <div class="mt-4 flex justify-center space-x-6">
                <a href="#" class="hover:text-blue-400 transition duration-300">Política de Privacidade</a>
                <span class="text-gray-600">|</span>
                <a href="#" class="hover:text-blue-400 transition duration-300">Termos de Uso</a>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const promotionsGrid = document.getElementById('promotions-grid');
            const loadingMessage = document.getElementById('loading-message');
            const errorMessage = document.getElementById('error-message');

            // Substitua 'SUA_URL_DA_CLOUD_FUNCTION_AQUI' pelo URL real da sua função do Google Cloud Functions
            // URL da função Steam Promotions: https://southamerica-east1-site-teste-462921.cloudfunctions.net/scrape-steam-promotions-function
            const jsonFilePath = 'https://southamerica-east1-site-teste-462921.cloudfunctions.net/scrape-steam-promotions-function'; 

            fetch(jsonFilePath)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status} - Verifique a URL da função Cloud Functions.`);
                    }
                    return response.json();
                })
                .then(data => {
                    loadingMessage.classList.add('hidden'); // Oculta a mensagem de carregamento
                    if (data && data.promotions && data.promotions.length > 0) {
                        promotionsGrid.innerHTML = ''; // Limpa o conteúdo de carregamento

                        data.promotions.forEach(promo => {
                            const articleElement = document.createElement('article');
                            articleElement.className = "bg-gray-800 rounded-lg shadow-lg overflow-hidden transition duration-300 hover:shadow-2xl";
                            
                            // Define uma imagem de fallback caso a URL esteja vazia, inválida ou não encontrada
                            const imageUrl = (promo.image_src && promo.image_src !== "URL da imagem não encontrada" && promo.image_src.startsWith('http')) 
                                ? promo.image_src 
                                : 'https://placehold.co/600x338/5A8DED/fff?text=IMAGEM+NÃO+DISPONÍVEL';

                            articleElement.innerHTML = `
                                <img src="${imageUrl}" alt="${promo.image_alt || 'Imagem do jogo'}" class="w-full h-48 object-cover">
                                <div class="p-6">
                                    <h4 class="text-xl font-semibold mb-3 text-white">
                                        <a href="${promo.link || '#'}" target="_blank" rel="noopener noreferrer" class="hover:text-blue-400 transition duration-300">${promo.title || 'Título não disponível'}</a>
                                    </h4>
                                    <div class="flex items-center mb-4">
                                        ${promo.discount_percent && promo.discount_percent !== "N/A" ? `<span class="discount-percent">${promo.discount_percent}</span>` : ''}
                                        ${promo.original_price && promo.original_price !== "Preço original não encontrado" ? `<span class="original-price">${promo.original_price}</span>` : ''}
                                        ${promo.final_price && promo.final_price !== "Preço final não encontrado" ? `<span class="final-price">${promo.final_price}</span>` : ''}
                                    </div>
                                    <p class="text-gray-400 text-base mb-4">
                                        ${promo.link ? 'Clique para ver os detalhes da promoção na Steam.' : 'Detalhes da promoção não disponíveis.'}
                                    </p>
                                    <a href="${promo.link || '#'}" target="_blank" rel="noopener noreferrer" class="text-blue-400 hover:underline font-medium">Ver na Steam &rarr;</a>
                                </div>
                            `;
                            promotionsGrid.appendChild(articleElement);
                        });
                    } else {
                        // Se não houver promoções nos dados ou os dados forem inválidos
                        promotionsGrid.innerHTML = '<p class="col-span-full text-center text-gray-400">Nenhuma promoção encontrada na URL da função Cloud Functions ou o resultado está vazio/inválido.</p>';
                    }
                })
                .catch(error => {
                    loadingMessage.classList.add('hidden'); // Oculta a mensagem de carregamento
                    errorMessage.classList.remove('hidden'); // Exibe a mensagem de erro
                    console.error('Erro ao carregar ou processar o JSON de promoções:', error);
                });
        });
    </script>
</body>
</html>
